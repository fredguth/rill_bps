type: "duckdb"
sql: "
SELECT
    item.ID_COMPRA, item.ID_ITEM, item.CODIGOBR, item.UNIDADE,
    item.REGISTRO_ANVISA, item.CNPJ_FORNECEDOR, item.CNPJ_FABRICANTE,
    item.QT_ITEM_COMPRA AS QT_UNIDADES,
    item.VL_ITEM_COMPRA AS VL_UNITARIO, (item.QT_ITEM_COMPRA * item.VL_ITEM_COMPRA) AS VL_TOTAL_ITEM,
    PJ1.RAZAO_SOCIAL AS FABRICANTE,
    PJ2.RAZAO_SOCIAL AS FORNECEDOR
FROM
    item
JOIN
    (SELECT CNPJ, RAZAO_SOCIAL FROM PJ) AS PJ1
ON
    item.CNPJ_FABRICANTE = PJ1.CNPJ
JOIN
    (SELECT CNPJ, RAZAO_SOCIAL FROM PJ) AS PJ2
ON
    item.CNPJ_FORNECEDOR = PJ2.CNPJ;

"
